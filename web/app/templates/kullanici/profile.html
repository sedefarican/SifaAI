{% extends 'base.html' %}

{% block title %}Profilim{% endblock %}

{% block content %}

<h2 class="mb-4 text-center" style="color: #0ABAB5;">👤 Profil Bilgileriniz</h2>

<!-- 🔹 KİŞİSEL VE SAĞLIK BİLGİLERİ -->
<div class="row row-cols-1 row-cols-md-2 g-4 mb-5">
  <div class="col">
    <div class="card h-100 shadow-sm" style="background-color: #E6F7F4;">
      <div class="card-body">
        <h5 class="card-title" style="color: #0ABAB5;">Kişisel Bilgiler</h5>
        <ul class="list-unstyled text-dark">
          <li><strong>Ad:</strong> {{ patient.name }}</li>
          <li><strong>Kullanıcı Adı:</strong> {{ patient.username }}</li>
          <li><strong>E-posta:</strong> {{ patient.email }}</li>
          <li><strong>Doğum Tarihi:</strong> {{ patient.birth_date }}</li>
          <li><strong>Yaş:</strong> {{ patient.age }}</li>
          <li><strong>Cinsiyet:</strong> {{ patient.gender }}</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="col">
    <div class="card h-100 shadow-sm" style="background-color: #E6F7F4;">
      <div class="card-body">
        <h5 class="card-title" style="color: #0ABAB5;">Sağlık Bilgileri</h5>
        <ul class="list-unstyled text-dark">
          <li><strong>Boy:</strong> {{ patient.height }} cm</li>
          <li><strong>Kilo:</strong> {{ patient.weight }} kg</li>
          <li><strong>Hastalıklar:</strong> {{ patient.illness|default:"Belirtilmedi" }}</li>
          <li><strong>İlaçlar:</strong> {{ patient.drugs|default:"Belirtilmedi" }}</li>
          <li><strong>Ameliyat Geçmişi:</strong> {{ patient.surgical_history|default:"Belirtilmedi" }}</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- 🔹 YÜKLENEN TAHLİL DOSYALARI VE AÇIKLAMALAR -->
<h4 class="mb-3" style="color: #0ABAB5;">📄 Önceki Tahlil Yorumları</h4>

{% if reports %}
  <div class="accordion mb-5" id="reportAccordion">
    {% for report in reports %}
      <div class="accordion-item">
        <h2 class="accordion-header" id="heading{{ forloop.counter }}">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ forloop.counter }}" aria-expanded="false" aria-controls="collapse{{ forloop.counter }}">
            {{ report.date|date:"d M Y, H:i" }} - Tahlil Detayını Gör
          </button>
        </h2>
        <div id="collapse{{ forloop.counter }}" class="accordion-collapse collapse" aria-labelledby="heading{{ forloop.counter }}" data-bs-parent="#reportAccordion">
          <div class="accordion-body" style="background-color: #F2FFFC;">
            <p style="white-space: pre-wrap;">{{ report.simple_comment }}</p>
            {% if report.advices %}
              <hr>
              <strong>🩺 Öneriler:</strong>
              <p style="white-space: pre-wrap;">{{ report.advices }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p class="text-muted">Henüz tahlil yüklenmemiş.</p>
{% endif %}


{% endblock %}
